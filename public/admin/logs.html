<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>System Logs - Admin</title>
    <link rel="stylesheet" href="/admin/admin-framework.css" />
    <style>
      .logs-container {
        background: var(--admin-card-bg);
        border-radius: var(--admin-radius-lg);
        margin-bottom: var(--admin-space-lg);
        box-shadow: var(--admin-shadow-md);
      }

      .logs-header {
        padding: var(--admin-space-lg);
        border-bottom: 1px solid var(--admin-border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: var(--admin-space-md);
      }

      .logs-filters {
        display: flex;
        gap: var(--admin-space-sm);
        flex-wrap: wrap;
        align-items: center;
      }

      .logs-content {
        max-height: 500px;
        overflow-y: auto;
        font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas,
          'Courier New', monospace;
        font-size: var(--admin-font-sm);
        line-height: 1.4;
      }

      .log-entry {
        padding: var(--admin-space-xs) var(--admin-space-md);
        border-bottom: 1px solid var(--admin-border);
        white-space: pre-wrap;
        word-break: break-all;
      }

      .log-entry:hover {
        background: var(--admin-primary-light);
      }

      .log-entry.error {
        background: rgba(239, 68, 68, 0.1);
        border-left: 3px solid var(--status-error);
      }

      .log-entry.warning {
        background: rgba(245, 158, 11, 0.1);
        border-left: 3px solid var(--status-warning);
      }

      .log-entry.info {
        background: rgba(59, 130, 246, 0.1);
        border-left: 3px solid var(--status-info);
      }

      .log-entry.success {
        background: rgba(16, 185, 129, 0.1);
        border-left: 3px solid var(--status-success);
      }

      .log-timestamp {
        color: var(--admin-text-secondary);
        margin-right: var(--admin-space-sm);
      }

      .log-level {
        display: inline-block;
        padding: 2px 6px;
        border-radius: 3px;
        font-size: 10px;
        font-weight: 600;
        text-transform: uppercase;
        margin-right: var(--admin-space-sm);
      }

      .log-level.error {
        background: var(--status-error);
        color: white;
      }

      .log-level.warning {
        background: var(--status-warning);
        color: white;
      }

      .log-level.info {
        background: var(--status-info);
        color: white;
      }

      .log-level.success {
        background: var(--status-success);
        color: white;
      }

      .log-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: var(--admin-space-md);
        margin-bottom: var(--admin-space-lg);
      }

      .stat-box {
        background: var(--admin-card-bg);
        padding: var(--admin-space-md);
        border-radius: var(--admin-radius-md);
        text-align: center;
        box-shadow: var(--admin-shadow-sm);
      }

      .stat-number {
        font-size: var(--admin-font-xl);
        font-weight: 700;
        color: var(--admin-primary);
      }

      .stat-label {
        font-size: var(--admin-font-xs);
        color: var(--admin-text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
    </style>
  </head>
  <body class="admin-body">
    <div class="admin-container">
      <!-- Breadcrumb Navigation -->
      <nav class="admin-breadcrumbs">
        <a href="/">üè† Home</a>
        <span class="separator">‚Üí</span>
        <a href="/admin/index.html">Admin Dashboard</a>
        <span class="separator">‚Üí</span>
        <span>System Logs</span>
      </nav>

      <!-- Header -->
      <header class="admin-header">
        <h1>üìã System Logs Viewer</h1>
        <p>Real-time server logs, error tracking, and system monitoring</p>
      </header>

      <!-- Log Statistics -->
      <section class="log-stats">
        <div class="stat-box">
          <div class="stat-number" id="total-logs">-</div>
          <div class="stat-label">Total Entries</div>
        </div>
        <div class="stat-box">
          <div class="stat-number admin-text-error" id="error-count">-</div>
          <div class="stat-label">Errors</div>
        </div>
        <div class="stat-box">
          <div class="stat-number admin-text-warning" id="warning-count">-</div>
          <div class="stat-label">Warnings</div>
        </div>
        <div class="stat-box">
          <div class="stat-number admin-text-info" id="info-count">-</div>
          <div class="stat-label">Info</div>
        </div>
      </section>

      <!-- Logs Container -->
      <section class="logs-container">
        <div class="logs-header">
          <h3 style="margin: 0; color: var(--admin-text)">
            üìÑ Recent Log Entries
          </h3>
          <div class="logs-filters">
            <select
              id="log-level-filter"
              class="admin-form-input"
              style="width: auto"
            >
              <option value="">All Levels</option>
              <option value="error">Errors</option>
              <option value="warning">Warnings</option>
              <option value="info">Info</option>
              <option value="success">Success</option>
            </select>
            <select
              id="log-source-filter"
              class="admin-form-input"
              style="width: auto"
            >
              <option value="">All Sources</option>
              <option value="server">Server</option>
              <option value="database">Database</option>
              <option value="auth">Authentication</option>
              <option value="api">API</option>
            </select>
            <button class="admin-btn admin-btn-sm" onclick="refreshLogs()">
              üîÑ Refresh
            </button>
            <button
              class="admin-btn admin-btn-sm admin-btn-secondary"
              onclick="clearLogs()"
            >
              üóëÔ∏è Clear
            </button>
            <button
              class="admin-btn admin-btn-sm admin-btn-success"
              onclick="exportLogs()"
            >
              üìÅ Export
            </button>
          </div>
        </div>
        <div class="logs-content" id="logs-content">
          <div
            style="
              padding: var(--admin-space-lg);
              text-align: center;
              color: var(--admin-text-secondary);
            "
          >
            Loading logs...
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer style="text-align: center; margin-top: var(--admin-space-xl)">
        <a href="/admin/index.html" class="admin-btn admin-btn-secondary"
          >‚Üê Back to Admin Dashboard</a
        >
      </footer>
    </div>

    <script>
      let logData = [];
      let filteredLogs = [];

      // Sample log data (in a real implementation, this would come from server logs)
      function generateSampleLogs() {
        const levels = ['error', 'warning', 'info', 'success'];
        const sources = ['server', 'database', 'auth', 'api'];
        const messages = {
          error: [
            'Database connection failed',
            'Failed to load user session',
            'Authentication token expired',
            'API rate limit exceeded',
            'File not found: /var/log/app.log',
          ],
          warning: [
            'High memory usage detected (85%)',
            'Slow query detected (2.3s)',
            'Redis connection timeout',
            'Large file upload (15MB)',
            'Cache miss rate above threshold',
          ],
          info: [
            'User logged in successfully',
            'Analytics data exported',
            'Cache cleared by admin',
            'Backup completed successfully',
            'Server started on port 3000',
          ],
          success: [
            'Health check passed',
            'Database backup completed',
            'Security scan clean',
            'Performance optimization applied',
            'SSL certificate renewed',
          ],
        };

        const logs = [];
        for (let i = 0; i < 50; i++) {
          const level = levels[Math.floor(Math.random() * levels.length)];
          const source = sources[Math.floor(Math.random() * sources.length)];
          const message =
            messages[level][Math.floor(Math.random() * messages[level].length)];
          const timestamp = new Date(Date.now() - Math.random() * 86400000 * 7); // Last 7 days

          logs.push({
            timestamp,
            level,
            source,
            message,
            id: `log_${i}_${Date.now()}`,
          });
        }

        return logs.sort((a, b) => b.timestamp - a.timestamp);
      }

      // Filter logs based on current filter settings
      function filterLogs() {
        const levelFilter = document.getElementById('log-level-filter').value;
        const sourceFilter = document.getElementById('log-source-filter').value;

        filteredLogs = logData.filter((log) => {
          const levelMatch = !levelFilter || log.level === levelFilter;
          const sourceMatch = !sourceFilter || log.source === sourceFilter;
          return levelMatch && sourceMatch;
        });

        displayLogs();
        updateStats();
      }

      // Display logs in the container
      function displayLogs() {
        const container = document.getElementById('logs-content');

        if (filteredLogs.length === 0) {
          container.innerHTML = `
                    <div style="padding: var(--admin-space-lg); text-align: center; color: var(--admin-text-secondary);">
                        No logs found matching current filters
                    </div>
                `;
          return;
        }

        const logEntries = filteredLogs
          .map(
            (log) => `
                <div class="log-entry ${log.level}" id="${log.id}">
                    <span class="log-timestamp">${log.timestamp.toLocaleString()}</span>
                    <span class="log-level ${log.level}">${log.level}</span>
                    <strong>[${log.source.toUpperCase()}]</strong> ${
              log.message
            }
                </div>
            `
          )
          .join('');

        container.innerHTML = logEntries;
      }

      // Update statistics
      function updateStats() {
        const totalLogs = filteredLogs.length;
        const errorCount = filteredLogs.filter(
          (log) => log.level === 'error'
        ).length;
        const warningCount = filteredLogs.filter(
          (log) => log.level === 'warning'
        ).length;
        const infoCount = filteredLogs.filter(
          (log) => log.level === 'info'
        ).length;

        document.getElementById('total-logs').textContent = totalLogs;
        document.getElementById('error-count').textContent = errorCount;
        document.getElementById('warning-count').textContent = warningCount;
        document.getElementById('info-count').textContent = infoCount;
      }

      // Refresh logs
      function refreshLogs() {
        logData = generateSampleLogs();
        filterLogs();
      }

      // Clear logs display
      function clearLogs() {
        if (confirm('Clear all logs from display?')) {
          logData = [];
          filteredLogs = [];
          displayLogs();
          updateStats();
        }
      }

      // Export logs
      function exportLogs() {
        const logText = filteredLogs
          .map(
            (log) =>
              `${log.timestamp.toISOString()} [${log.level.toUpperCase()}] [${log.source.toUpperCase()}] ${
                log.message
              }`
          )
          .join('\\n');

        const blob = new Blob([logText], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `system-logs-${
          new Date().toISOString().split('T')[0]
        }.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      // Set up event listeners
      document.addEventListener('DOMContentLoaded', () => {
        // Initialize logs
        refreshLogs();

        // Set up filter listeners
        document
          .getElementById('log-level-filter')
          .addEventListener('change', filterLogs);
        document
          .getElementById('log-source-filter')
          .addEventListener('change', filterLogs);

        // Auto-refresh every 30 seconds
        setInterval(refreshLogs, 30000);
      });
    </script>
  </body>
</html>
