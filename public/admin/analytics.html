<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Analytics Dashboard - Admin</title>
    <link rel="stylesheet" href="/admin/admin-framework.css" />
    <link rel="stylesheet" href="/admin/analytics.css" />
    <style>
      /* Analytics-specific enhancements */
      .analytics-header {
        background: var(--admin-card-bg);
        padding: var(--admin-space-lg);
        border-radius: var(--admin-radius-lg);
        margin-bottom: var(--admin-space-lg);
        box-shadow: var(--admin-shadow-md);
      }

      .analytics-controls {
        background: var(--admin-card-bg);
        padding: var(--admin-space-lg);
        border-radius: var(--admin-radius-lg);
        margin-bottom: var(--admin-space-lg);
        box-shadow: var(--admin-shadow-md);
      }

      .control-row {
        display: flex;
        flex-wrap: wrap;
        gap: var(--admin-space-md);
        align-items: center;
        margin-bottom: var(--admin-space-md);
      }

      .control-group {
        display: flex;
        align-items: center;
        gap: var(--admin-space-xs);
      }

      .export-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: var(--admin-space-xs);
      }
    </style>
  </head>
  <body class="admin-body">
    <main class="admin-container">
      <!-- Breadcrumb Navigation -->
      <nav class="admin-breadcrumbs">
        <a href="/">ğŸ  Home</a>
        <span class="separator">â†’</span>
        <a href="/admin/index.html">Admin Dashboard</a>
        <span class="separator">â†’</span>
        <span>Analytics</span>
      </nav>

      <!-- Header -->
      <header class="analytics-header">
        <h1 style="margin: 0 0 var(--admin-space-sm) 0; font-size: var(--admin-font-3xl);">ğŸ“Š Analytics Dashboard</h1>
        <p style="margin: 0; color: var(--admin-text-secondary);">
          Comprehensive website analytics with real-time insights and advanced filtering
        </p>
        <div class="admin-breadcrumbs" style="margin-top: var(--admin-space-md); padding: var(--admin-space-sm);">
          <a href="/admin/index.html">ğŸ  Admin Dashboard</a>
          <span class="separator">|</span>
          <a href="/health-dashboard">ğŸ¥ Health Dashboard</a>
          <span class="separator">|</span>
          <a href="/admin/login.html">ğŸ” Login</a>
          <span class="separator">|</span>
          <a href="/">â† Main Site</a>
        </div>
      </header>

      <!-- Enhanced Controls -->
      <section class="analytics-controls">
        <!-- Authentication Controls -->
        <div class="control-row">
          <div class="control-group">
            <label class="admin-form-label">Admin Token:</label>
            <input
              id="admin-token"
              type="password"
              class="admin-form-input"
              placeholder="Paste admin secret token"
              style="width: 250px;"
            />
          </div>
          <button id="save-token" class="admin-btn admin-btn-sm">Save Token</button>
          <button id="login-cookie" class="admin-btn admin-btn-sm admin-btn-secondary">Login (Cookie)</button>
          <button id="logout" class="admin-btn admin-btn-sm admin-btn-warning">Logout</button>
          <span id="token-status" class="admin-text-secondary">Not logged in</span>
        </div>

        <!-- Filter Controls -->
        <div class="control-row">
          <div class="control-group">
            <label class="admin-form-label" for="limit">Limit:</label>
            <select id="limit" class="admin-form-input" style="width: auto;">
              <option value="10">10 events</option>
              <option value="25">25 events</option>
              <option value="50">50 events</option>
              <option value="100" selected>100 events</option>
              <option value="250">250 events</option>
              <option value="500">500 events</option>
            </select>
          </div>

          <div class="control-group">
            <label class="admin-form-label" for="event-filter">Event Type:</label>
            <select id="event-filter" class="admin-form-input" style="width: auto;">
              <option value="">All Events</option>
              <option value="pageview">Pageviews</option>
              <option value="scroll">Scroll Events</option>
              <option value="click">Click Events</option>
              <option value="unknown">Unknown</option>
            </select>
          </div>

          <button id="load" class="admin-btn">ğŸ”„ Load Analytics</button>
          <button id="clear-cache" class="admin-btn admin-btn-secondary">Clear View</button>
        </div>

        <!-- Export Controls -->
        <div class="control-row">
          <div class="export-buttons">
            <button id="export-csv" class="admin-btn admin-btn-sm admin-btn-success">ğŸ“Š Export CSV</button>
            <button id="export-rss" class="admin-btn admin-btn-sm admin-btn-success">ğŸ“¡ Export RSS</button>
            <button id="server-export" class="admin-btn admin-btn-sm admin-btn-success">â¬‡ï¸ Server Export</button>
            <button id="json-export" class="admin-btn admin-btn-sm admin-btn-success">ğŸ“„ JSON Export</button>
          </div>
        </div>
      </section>

      <div id="status" class="admin-card admin-p-md admin-mb-lg admin-text-center">Not loaded</div>

      <!-- Stats Grid with Modern Design -->
      <section class="admin-card admin-mb-lg">
        <div class="admin-p-lg">
          <h3 style="margin: 0 0 var(--admin-space-md) 0; color: var(--admin-text);">ğŸ“ˆ Analytics Overview</h3>
          <div id="stats-grid" class="admin-status-grid" style="display: none;">
            <div class="admin-status-card">
              <div class="admin-status-label">Total Events</div>
              <div class="admin-status-value" id="total-events">-</div>
            </div>
            <div class="admin-status-card">
              <div class="admin-status-label">Unique IPs</div>
              <div class="admin-status-value" id="unique-ips">-</div>
            </div>
            <div class="admin-status-card">
              <div class="admin-status-label">Event Types</div>
              <div class="admin-status-value" id="event-types">-</div>
            </div>
            <div class="admin-status-card">
              <div class="admin-status-label">Latest Event</div>
              <div class="admin-status-value" id="latest-event">-</div>
              <div class="admin-status-label">minutes ago</div>
            </div>
          </div>
        </div>
      </section>

      <!-- cURL Examples -->
      <section class="admin-card admin-mb-lg">
        <div class="admin-p-lg">
          <h4 style="margin: 0 0 var(--admin-space-md) 0; color: var(--admin-text);">ğŸ”§ API Examples</h4>
          <pre id="curl-examples" style="background: var(--admin-primary-light); padding: var(--admin-space-md); border-radius: var(--admin-radius-md); font-family: monospace; font-size: var(--admin-font-sm); color: var(--admin-text);"># cURL examples will appear here</pre>
        </div>
      </section>

      <!-- Events Table -->
      <section class="admin-card">
        <div class="admin-p-lg">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--admin-space-md);">
            <h3 style="margin: 0; color: var(--admin-text);">ğŸ“‹ Recent Events</h3>
            <div class="admin-text-secondary" id="events-count">-</div>
          </div>

          <div style="max-height: 600px; overflow-y: auto; border: 1px solid var(--admin-border); border-radius: var(--admin-radius-md);">
            <table id="events-table" class="admin-table">
              <thead>
                <tr>
                  <th>Timestamp</th>
                  <th>IP</th>
                  <th>Event</th>
                  <th>Path</th>
                  <th>User Agent</th>
                  <th>Data</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>
    </main>

    <script src="/admin/analytics.js"></script>
  </body>
</html>
    </main>

    <script src="/admin/analytics.js"></script>
  </body>
</html>
